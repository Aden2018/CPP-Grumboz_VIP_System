/////////////////////////////////////////////////////
/////////////////////////////////////////////////////
-----------------------------------------------------
src/server/game/entities/Unit/Statsystem.cpp

at top with #includes
[CODE]
#include "Grumboz_VIP_Core.h"
#include "WorldSession.h"
[/CODE]

line 249 add these lines inside void Player::UpdateArmor()
[CODE]
	float VIP_OFFSET = sVIP->GetVIPOFFSET();
	uint32 acctId = GetSession()->GetAccountId();
	uint8 Pvip = sVIP->GetPlayerVIP(acctId);
	float MOD = (Pvip * VIP_OFFSET);
[/CODE]

line 271 inside void Player::UpdateArmor()
replace SetArmor(int32(value)); with:

[CODE]
	uint32 THP = (uint32)value * MOD;
	int32 HPMOD = (int32)value + THP;

	SetArmor(int32(HPMOD));
[/CODE]
-----------------------------------------------------
/////////////////////////////////////////////////////
/////////////////////////////////////////////////////
-----------------------------------------------------
